## HTML 版本
```
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>文本转语音并保存为音频</title>
</head>
<body>
    <h1>文本转语音并保存为音频</h1>
    
    <label for="textInput">请输入文本：</label><br>
    <textarea id="textInput" rows="4" cols="50"></textarea><br><br>

    <label for="voiceSelect">选择中文语音：</label>
    <select id="voiceSelect"></select><br><br>

    <button id="startButton">开始朗读并下载</button>

    <script>
        // 获取可用的中文语音并填充选择框
        function populateVoiceList() {
            const voices = speechSynthesis.getVoices();
            const voiceSelect = document.getElementById('voiceSelect');
            voiceSelect.innerHTML = ''; // 清空现有选项

            // 过滤中文语音
            const chineseVoices = voices.filter(voice => voice.lang === 'zh-CN' || voice.lang === 'zh-TW');
            
            // 将中文语音填充到下拉框
            chineseVoices.forEach((voice) => {
                const option = document.createElement('option');
                option.value = voice.name;
                option.textContent = voice.name;
                voiceSelect.appendChild(option);
            });
        }

        // 创建朗读函数并启动音频合成与录音
        function speakAndRecord(text, selectedVoice) {
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'zh-CN'; // 设置中文语音
            utterance.voice = selectedVoice; // 设置选择的音色

            // 请求音频捕获权限（重要：用户需选择系统音频监视器输入，以捕获内部音频输出）
            navigator.mediaDevices.getUserMedia({ audio: true })
                .then(stream => {
                    let mediaRecorder = new MediaRecorder(stream);
                    let audioChunks = [];

                    mediaRecorder.ondataavailable = (event) => {
                        if (event.data.size > 0) {
                            audioChunks.push(event.data);
                        }
                    };

                    mediaRecorder.onstop = () => {
                        const audioBlob = new Blob(audioChunks, { type: 'audio/wav' });
                        const audioUrl = URL.createObjectURL(audioBlob);

                        // 自动下载
                        const link = document.createElement('a');
                        link.href = audioUrl;
                        link.download = 'speech_output.wav';
                        link.click();

                        // 重置
                        audioChunks = [];
                    };

                    // 当语音开始时启动录音
                    utterance.onstart = () => {
                        mediaRecorder.start();
                    };

                    // 当语音结束时停止录音（添加轻微延迟以捕获尾音）
                    utterance.onend = () => {
                        setTimeout(() => {
                            mediaRecorder.stop();
                        }, 500); // 500ms 延迟，确保捕获完整音频
                    };

                    // 启动语音合成
                    speechSynthesis.speak(utterance);
                })
                .catch(err => {
                    console.error('音频捕获错误:', err);
                    alert('无法访问音频设备。请检查权限并确保选择音频监视器输入（如果可用）。');
                });
        }

        // 执行朗读
        document.getElementById('startButton').addEventListener('click', () => {
            const textInput = document.getElementById('textInput').value.trim();
            const selectedVoiceName = document.getElementById('voiceSelect').value;
            const voices = speechSynthesis.getVoices();
            const selectedVoice = voices.find(voice => voice.name === selectedVoiceName);

            if (textInput) {
                alert('请在权限提示中选择音频监视器/循环输入（monitor/loopback），以捕获浏览器内部音频。如果不可用，可能需安装虚拟音频设备。');
                speakAndRecord(textInput, selectedVoice);
            } else {
                alert('请输入文本');
            }
        });

        // 初始化并填充可用的中文语音列表
        populateVoiceList();
        
        // 在语音列表加载完后，重新填充语音选择框
        if (speechSynthesis.onvoiceschanged !== undefined) {
            speechSynthesis.onvoiceschanged = populateVoiceList;
        }
    </script>
</body>
</html>

```