删除重复图像
## 安装依赖
```
pip install opencv-python numpy keras tensorflow
```
## 脚本程序
```
import os
import cv2
import numpy as np
from keras.applications.resnet50 import ResNet50, preprocess_input

# 加载ResNet50模型用于提取图像特征
model = ResNet50(weights='imagenet', include_top=False, input_shape=(224, 224, 3))

def extract_image_features(image_path):
    image = cv2.imread(image_path)  # 读取图片
    image = cv2.resize(image, (224, 224))  # 调整图片大小
    image = np.expand_dims(image, axis=0)  # 扩展维度
    image = preprocess_input(image)  # 预处理图片
    
    features = model.predict(image)  # 提取特征
    features = features.flatten()  # 展平特征向量
    features /= np.linalg.norm(features)  # 特征向量归一化
    
    return features

def delete_duplicate_images(directory):
    images = []
    features = []
    to_delete = []
    
    # 遍历目录中的所有文件
    for filename in os.listdir(directory):
        file_path = os.path.join(directory, filename)
        if os.path.isfile(file_path):
            try:
                image_features = extract_image_features(file_path)
                for i, feature in enumerate(features):
                    # 计算图像之间的余弦相似度
                    similarity = np.dot(image_features, feature) / (np.linalg.norm(image_features) * np.linalg.norm(feature))
                    if similarity > 0.99:  # 设定一个阈值，判断图片是否相似
                        print(f"Found duplicate: {filename} and {images[i]}")
                        to_delete.append(file_path)
                        break
                else:
                    images.append(filename)
                    features.append(image_features)
            except Exception as e:
                print(f"Error processing {filename}: {e}")
    
    # 删除重复的图片
    for file_path in to_delete:
        os.remove(file_path)
        print(f"Deleted duplicate image: {file_path}")

# 设置图片文件夹路径
directory = r'D:\test'
delete_duplicate_images(directory)
```